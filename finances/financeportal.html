<!DOCTYPE html>
<head>
    <link rel="stylesheet" type = "text/css" href="financeportalCSS.CSS"/>
    <link rel="stylesheet" type = "text/css" href="../menubar+footerCSS.css"/>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
   crossorigin=""></script>
   <script src="financeportalJS.js"></script>
   
</head>

<html>
    <body>
        <div id="maindiv">
            <div id="generalanalysisdiv">

            </div>

            <div id="portalcontent">
                <div id="jobFinder">
                    <div id="jobfinderheader">
                        <label for="radiusinput">Find Job Within: </label>
                        <input type="number", placeholder="in KM", id="radiusinput">
                        <input type="button", value="Find Jobs", id="findjobsbtn" onclick="findJobs()">
                    </div>
                    <div id="mapid">
                    
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>

<script>
    
    var latlng;
    var mymap = L.map('mapid');

    L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
        maxZoom: 18,
        id: 'mapbox/streets-v11',
        tileSize: 512,
        zoomOffset: -1,
        accessToken: 'pk.eyJ1Ijoiam9leTExMDk4IiwiYSI6ImNraTEzdjB4YjB3NWYyeXBldjM4NjQ0aHAifQ.v-dSyyCZbDH56rXtIoxMnw'
    }).addTo(mymap);


    function findJobs() {

        if(document.getElementById("radiusinput").value == "" || document.getElementById("radiusinput").value == "0") {
            alert("Enter a KM Value!");
        } else{
            
            var greenIcon = new L.Icon({
            iconUrl: 'marker.png',
        
            iconSize: [42.71, 50],
            iconAnchor: [12, 41],
            popupAnchor: [1, -34],
            
            });
            var marker = L.marker(latlng, {icon: greenIcon}).addTo(mymap);
            mymap.setView(latlng, 13);


            var bounds = [[latlng.lat+0.24, latlng.lng+0.35], [latlng.lat-0.24, latlng.lng-0.35]];
            L.rectangle(bounds, {color: "#ff7800", weight: 1});

            var latmax = latlng.lat+0.24;
            var latmini = latlng.lat-0.24;
            var lngmax = latlng.lng+0.35;
            var lngmini = latlng.lng-0.35;
            
            var radiusval = document.getElementById("radiusinput").value;
            
            L.circle(latlng, {radius: radiusval*1000}).addTo(mymap);
            var radlong = radiusval/110.6;

            if(1.5*radiusval <= 20)
            numOfJobs = 1.5*radiusval
            else
            numOfJobs = 20;
            
            for(i=0;i<numOfJobs;i++) {
                var angle = Math.random()*2*Math.PI;
                var distance = Math.random()*radlong;
                var randommarker = L.marker([distance*Math.cos(angle)+latlng.lat,distance*Math.sin(angle)+latlng.lng]).addTo(mymap);

            }
        }
    }

    navigator.geolocation.getCurrentPosition(function(location) {
    latlng = new L.LatLng(location.coords.latitude, location.coords.longitude);
    });
    
</script>

